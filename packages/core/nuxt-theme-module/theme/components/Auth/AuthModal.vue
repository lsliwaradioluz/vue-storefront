<template>
  <SfModal
    v-e2e="'login-modal'"
    :visible="isAuthModalOpen"
    class="auth-modal"
    @close="toggleAuthModal"
  >
    <template #modal-bar>
      <SfBar
        class="sf-modal__bar smartphone-only"
        :close="true"
        :title="currentAuthModal === 'login' ? $t('Log in') : $t('Sign in')"
        @click:close="toggleAuthModal"
      />
    </template>
    <transition name="sf-fade" mode="out-in">
      <LoginForm v-if="currentAuthModal === 'login'" />
      <RegisterForm v-else />
    </transition>
  </SfModal>
</template>

<script>
import { SfBar, SfModal } from '@storefront-ui/vue';
import { useUiState } from '~/composables';

export default {
  name: 'AuthModal',
  components: {
    SfModal,
    SfBar,
    LoginForm: () => import('~/components/Auth/LoginForm'),
    RegisterForm: () => import('~/components/Auth/RegisterForm')
  },
  setup() {
    const { isAuthModalOpen, toggleAuthModal, currentAuthModal } = useUiState();

    return {
      isAuthModalOpen,
      toggleAuthModal,
      currentAuthModal
    };
  }
};
</script>

<style lang='scss'>
.auth-modal {
  .sf-modal {
    &__container {
      z-index: var(--modal-index, 9);
    }
  }
}
</style>
